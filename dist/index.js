!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["firebase-uploader"]=t():e["firebase-uploader"]=t()}(window,function(){return function(e){var t={};function i(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){"use strict";i.r(t);var a=function(e,t,i,a,n,r,o,l){var s=typeof(e=e||{}).default;"object"!==s&&"function"!==s||(e=e.default);var d,f="function"==typeof e?e.options:e;if(t&&(f.render=t,f.staticRenderFns=i,f._compiled=!0),a&&(f.functional=!0),r&&(f._scopeId=r),o?(d=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(o)},f._ssrRegister=d):n&&(d=l?function(){n.call(this,this.$root.$options.shadowRoot)}:n),d)if(f.functional){f._injectStyles=d;var c=f.render;f.render=function(e,t){return d.call(t),c(e,t)}}else{var u=f.beforeCreate;f.beforeCreate=u?[].concat(u,d):[d]}return{exports:e,options:f}}({name:"FirebaseUploader",data:()=>({hasError:!1,loading:!1,defaultImage:!1,hasFile:!1,fileLink:""}),computed:{acceptedFileFormat:function(){return this.limitToType.join(",")}},created:function(){this.getMetaData()()},props:{uploadFileLabel:{type:String,default:"Upload a file"},deleteFileLabel:{type:String,default:"Remove this file"},unsuportedMediaTypeLabel:{type:String,default:"Unsuported Media Type. Please use a correct file format"},path:{type:String,required:!0},storage:{type:Object,required:!0},targetFileName:{type:String,required:!0},limitToType:{type:Array,default:()=>[]}},methods:{targetPath:function(){return this.path+"/"+this.targetFileName},getFileRef:function(){return this.storage.ref().child(this.targetPath())},resetUpload:function(){let e=this.$refs.loader;e.replaceWith(e.val("").clone(!0))},onChangeLoader:function(){event.target.files[0]&&this.uploadFile(event.target.files[0])},getMetaData:function(){this.loading=!0,this.getFileRef().getMetadata().then(e=>{this.fileLink=e.downloadURLs[0],this.hasFile=!0,this.loading=!1,"file"===e.type&&-1!==e.contentType.indexOf("image/")&&(this.defaultImage=e.downloadURLs[0])}).catch(()=>{this.loading=!1,this.defaultImage=!1})},uploadFile:function(e){if(this.limitToType.length>=1&&-1===this.limitToType.indexOf(e.type))return this.hasError=!0,!1;this.hasError=!1,this.loading=!0,this.getFileRef().put(e).then(()=>{this.getMetaData(),this.loading=!1,this.$emit("onUpload",this.targetPath())}).catch(()=>{this.$emit("onUploadError",this.targetPath()),this.loading=!1})},deleteFile:function(){this.loading=!0,this.getFileRef().delete().then(()=>{this.loading=!1,this.defaultImage=!1,this.hasFile=!1,this.resetUpload(),this.$emit("onDelete",this.targetPath())}).catch(()=>{this.loading=!1})}}},function(){var e=this,t=this,i=t.$createElement,a=t._self._c||i;return a("v-flex",{attrs:{xs12:"",sm3:""}},[a("v-card",[!1!==this.defaultImage?a("v-card-media",{attrs:{src:this.defaultImage,height:"200px"}}):t._e(),t._v(" "),a("v-alert",{attrs:{outline:"",color:"error",icon:"warning",value:t.hasError}},[t._v(t._s(this.unsuportedMediaTypeLabel))]),t._v(" "),this.hasFile?a("v-card-actions",[a("v-flex",{attrs:{sm6:""}},[a("v-btn",{attrs:{flat:"",block:"",target:"_blank",href:this.fileLink}},[a("v-icon",{attrs:{dark:""}},[t._v("file_download")])],1)],1),t._v(" "),a("v-flex",{attrs:{sm6:""}},[a("v-btn",{attrs:{flat:"",block:"",loading:t.loading,title:this.deleteFileLabel},on:{click:function(){e.deleteFile()}}},[a("v-icon",{attrs:{dark:""}},[t._v("delete")])],1)],1)],1):a("v-card-actions",[a("input",{ref:"loader",attrs:{type:"file",accept:t.acceptedFileFormat,hidden:""},on:{change:t.onChangeLoader}}),t._v(" "),a("v-btn",{attrs:{flat:"",loading:t.loading,block:""},on:{click:function(){e.$refs.loader.click()}}},[t._v(t._s(this.uploadFileLabel))])],1)],1)],1)},[],!1,null,null,null).exports;i.d(t,"FirebaseUploader",function(){return a});t.default={install(e){e.component("firebaseUploader",a)}}}])});