!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["firebase-uploader"]=t():e["firebase-uploader"]=t()}(window,function(){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,i),a.l=!0,a.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){"use strict";i.r(t);var n=function(e,t,i,n,a,r,o,l){var s=typeof(e=e||{}).default;"object"!==s&&"function"!==s||(e=e.default);var d,u="function"==typeof e?e.options:e;if(t&&(u.render=t,u.staticRenderFns=i,u._compiled=!0),n&&(u.functional=!0),r&&(u._scopeId=r),o?(d=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),a&&a.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(o)},u._ssrRegister=d):a&&(d=l?function(){a.call(this,this.$root.$options.shadowRoot)}:a),d)if(u.functional){u._injectStyles=d;var f=u.render;u.render=function(e,t){return d.call(t),f(e,t)}}else{var c=u.beforeCreate;u.beforeCreate=c?[].concat(c,d):[d]}return{exports:e,options:u}}({name:"FirebaseUploader",data:()=>({hasError:!1,loading:!1,defaultImage:!1,hasFile:!1}),created:function(){this.getMetaData()()},props:{uploadFileLabel:{type:String,default:"Upload a file"},deleteFileLabel:{type:String,default:"Remove this file"},unsuportedMediaTypeLabel:{type:String,default:"Unsuported Media Type. Please use a correct file format"},path:{type:String,required:!0},storage:{type:Object,required:!0},targetFileName:{type:String,required:!0},limitToType:{type:Array,default:()=>[]}},methods:{targetPath:function(){return this.path+"/"+this.targetFileName},getFileRef:function(){return this.storage.ref().child(this.targetPath())},resetUpload:function(){let e=this.$refs.loader;e.replaceWith(e.val("").clone(!0))},onChangeLoader:function(){event.target.files[0]&&this.uploadFile(event.target.files[0])},getMetaData:function(){this.loading=!0,this.getFileRef().getMetadata().then(e=>{this.hasFile=!0,this.loading=!1,"file"===e.type&&-1!==e.contentType.indexOf("image/")&&(this.defaultImage=e.downloadURLs[0])}).catch(()=>{this.loading=!1,this.defaultImage=!1})},uploadFile:function(e){if(this.limitToType.length>=1&&-1===this.limitToType.indexOf(e.type))return this.hasError=!0,!1;this.hasError=!1,this.loading=!0,this.getFileRef().put(e).then(()=>{this.getMetaData(),this.loading=!1,this.$emit("onUpload",this.targetPath())}).catch(()=>{this.$emit("onUploadError",this.targetPath()),this.loading=!1})},deleteFile:function(){this.loading=!0,this.getFileRef().delete().then(()=>{this.loading=!1,this.defaultImage=!1,this.hasFile=!1,this.resetUpload(),this.$emit("onDelete",this.targetPath())}).catch(()=>{this.loading=!1})}}},function(){var e=this,t=this,i=t.$createElement,n=t._self._c||i;return n("v-flex",{attrs:{xs12:"",sm3:""}},[n("v-card",[!1!==this.defaultImage?n("v-card-media",{attrs:{src:this.defaultImage,height:"200px"}}):t._e(),t._v(" "),n("v-alert",{attrs:{outline:"",color:"error",icon:"warning",value:t.hasError}},[t._v(t._s(this.unsuportedMediaTypeLabel))]),t._v(" "),n("v-card-actions",[n("input",{ref:"loader",attrs:{type:"file",hidden:""},on:{change:t.onChangeLoader}}),t._v(" "),this.hasFile?n("v-btn",{attrs:{flat:"",loading:t.loading,block:""},on:{click:function(){e.deleteFile()}}},[t._v(t._s(this.deleteFileLabel))]):n("v-btn",{attrs:{flat:"",loading:t.loading,block:""},on:{click:function(){e.$refs.loader.click()}}},[t._v(t._s(this.uploadFileLabel))])],1)],1)],1)},[],!1,null,null,null).exports;i.d(t,"FirebaseUploader",function(){return n});t.default={install(e){e.component("firebaseUploader",n)}}}])});